from src.preprocess_data import apply_changes
import pytest


@pytest.mark.parametrize("note_set,changes,major,expected", [
    ([0, 4, 7], "2", True, [2, 4, 7]),
    ([0, 4, 7], "4", True, [0, 5, 7]),
    ([0, 3, 7], "4", True, [0, 5, 7]),
    ([0, 4, 7], "6", True, [0, 4, 9]),
    ([0, 3, 6], "6", True, [0, 3, 8]),
    ([0, 4, 7], "6", False, [0, 4, 8]),
    ([0, 4, 7], "64", True, [0, 5, 9]),
    ([0, 4, 7], "64", False, [0, 5, 8]),
    ([0, 4, 7, 10], "64", True, [0, 5, 9, 10]),
    ([0, 4, 7, 10], "64", False, [0, 5, 8, 10]),
    ([0, 4, 7], "9", True, [0, 4, 7, 2]),
    ([0, 4, 7, 10], "9", True, [0, 4, 7, 10, 2]),
    ([0, 4, 7], "+9", True, [0, 4, 7, 2]),
    ([0, 4, 7, 10], "+9", True, [0, 4, 7, 10, 2]),
    ([0, 4, 7], "+2", True, [0, 4, 7, 2]),
    ([0, 4, 7], "+4", True, [0, 4, 7, 5]),
    ([0, 3, 7], "+4", True, [0, 3, 7, 5]),
    ([0, 4, 7], "+6", True, [0, 4, 7, 9]),
    ([0, 4, 7], "+6", False, [0, 4, 7, 8]),
    ([0, 3, 7], "+6", True, [0, 3, 7, 8]),
    ([0, 4, 7], "7", True, [0, 4, 7, 11]),
    ([0, 4, 7], "#7", True, [0, 4, 7, 11]),
    ([0, 3, 7], "7", True, [0, 3, 7, 11]),
    ([0, 4, 7], "#2", True, [0, 3, 7]),
    ([0, 3, 7], "#4", True, [0, 3, 6]),
    ([0, 4, 7], "#4", True, [0, 4, 6]),
    ([0, 3, 7], "b6", False, [0, 3, 8]),
    ([0, 4, 7], "b6", True, [0, 4, 8]),
    ([0, 4, 7, 10], "b9", True, [0, 4, 7, 10, 1]),
    ([0, 4, 7, 10], "+b9", True, [0, 4, 7, 10, 1]),
    #b2 b4 b5 b7 #5 5 #3 #1 etc  
])
def test_apply_changes(note_set, changes, major, expected):
    assert apply_changes(note_set, changes, major) == expected